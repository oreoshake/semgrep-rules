rules:
  - id: index-may-be-needed
    patterns:
      - pattern-not-inside: |
          add_column $TABLE, $COLUMN, $TYPE, ...
          ...
          add_index $TABLE, $COLUMN, ...
      - pattern: |
          add_column $TABLE, $COLUMN, $TYPE, ...
      - metavariable-regex:
          metavariable: $COLUMN
          regex: (.*_id$)
      - metavariable-regex:
          metavariable: $COLUMN
          regex: (.*_id$)
      - metavariable-regex:
          metavariable: $TYPE
          regex: (:integer)
    message: >
      The $COLUMN column appears to be a foreign key. Would it benefit from an
      index?
    languages:
      - ruby
    severity: INFO
